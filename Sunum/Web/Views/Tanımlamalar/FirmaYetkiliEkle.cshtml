@model YetkililerModel

@using (Html.BeginForm("YetkiliEkle", "Tanımlamalar", new { returnUrl = this.Request.RawUrl }, FormMethod.Post))
{

    foreach (var tumSehirler in EngineContext.Current.Resolve<Services.Konum.IKonumServisi>().SehirlerAlUlkeId(1))
    {
        var sehirModel = tumSehirler.ToModel();
        Model.Sehirler.Add(sehirModel);
    }
    foreach (var tumIlceler in EngineContext.Current.Resolve<Services.Konum.IKonumServisi>().IlcelerAlSehirId(1))
    {
        var ilceModel = tumIlceler.ToModel();
        Model.Ilceler.Add(ilceModel);
    }
    foreach (var unvanlar in EngineContext.Current.Resolve<Services.EkTanımlamalar.IUnvanlarServisi>().TümUnvanlarıAl())
    {
        var unvan = unvanlar.ToModel();
        Model.Görevler.Add(unvanlar);
    }
    <div class="content clearfix">
        <div class="form-horizontal">
            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal"
                                    aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                            <h4 class="modal-title" id="myModalLabel">Yeni Yetkili Ekle</h4>
                        </div>
                        <div class="modal-body">
                            <script type="text/javascript">
                                $(document).on('change', '#YSehirId', function () {
                                    var selectedItem = $(this).val();
                                    var ddlIlce2 = $('#YIlceId');
                                    var ilceProgress2 = $("#ilce-loading-progress");
                                    ilceProgress2.show();
                                    $('#YIlceId').html('');
                                    $.ajax({

                                        cache: false,
                                        type: "GET",
                                        /**/
                                        url: "@Html.Raw(Url.Action("IlceAlSehirId", "Tanımlamalar"))",
                                        /**/
                                        data: { "sehirId": selectedItem },
                                        success: function (data) {
                                            ddlIlce2.html('');
                                            $.each(data, function (id, option) {
                                                $('#YIlceId').append($('<option></option>').val(option.id).html(option.name));
                                            });
                                            ilceProgress2.hide();
                                        },
                                        error: function (xhr, ajaxOptions, thrownError) {
                                            alert('İlçeler alınırken hata oluştu.');
                                            ilceProgress2.hide();
                                        }
                                    });
                                });
                            </script>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.UnvanId)
                                </div>
                                <div class="col-md-10">
                                    @Html.DropDownListFor_(m => m.UnvanId, new SelectList(Model.Görevler, "Id", "Adı", selectedValue: Model.UnvanId))
                                    @Html.ValidationMessageFor(m => m.UnvanId)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.Adı)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.Adı)
                                    @Html.ValidationMessageFor(m => m.Adı)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.Soyadı)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.Soyadı)
                                    @Html.ValidationMessageFor(m => m.Soyadı)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.CepTel1)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.CepTel1)
                                    @Html.ValidationMessageFor(m => m.CepTel1)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.CepTel2)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.CepTel2)
                                    @Html.ValidationMessageFor(m => m.CepTel2)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.Email1)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.Email1)
                                    @Html.ValidationMessageFor(m => m.Email1)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.Email2)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.Email2)
                                    @Html.ValidationMessageFor(m => m.Email2)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.Adres)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.Adres)
                                    @Html.ValidationMessageFor(m => m.Adres)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.YSehirId)
                                </div>
                                <div class="col-md-10">
                                    @Html.DropDownListFor_(model => model.YSehirId, new SelectList(Model.Sehirler, "Id", "Adı"))
                                    @Html.ValidationMessageFor(m => m.YSehirId)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.YIlceId)
                                </div>
                                <div class="col-md-10">
                                    @Html.DropDownListFor_(model => model.YIlceId, new SelectList(Model.Ilceler, "Id", "Adı"))
                                    <span id="ilce-loading-progress" style="display: none;">Lütfen bekleyiniz..</span>
                                    @Html.ValidationMessageFor(m => m.YIlceId)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.PostaKodu)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.PostaKodu)
                                    @Html.ValidationMessageFor(m => m.PostaKodu)
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-2">
                                    @Html.LabelFor_(m => m.DoğumTarihi)
                                </div>
                                <div class="col-md-10">
                                    @Html.EditorFor_(m => m.DoğumTarihi)
                                    @Html.ValidationMessageFor(m => m.DoğumTarihi)
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="submit" class="btn btn-success">Kaydet</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}
