@model String

@using Core
@using Core.Domain.Genel
@using Services.Güvenlik
@using Web.Framework.UI

@{
    Html.ScriptParçasıEkle("~/Content/tinymce/tinymce.min.js", true);
    var izinServisi = EngineContext.Current.Resolve<IİzinServisi>();

    var JbResimleriEtkin = false;
    var language = "tr";
    var allowRoxyFileman = izinServisi.YetkiVer(StandartİzinSağlayıcı.HTMLEditörResimleriYönet);
    var rastgele = GenelYardımcı.RastgeleTamSayıÜret();
    var ekEditorAyarları = EngineContext.Current.Resolve<AdminAyarları>().RichEditorEkAyarları;
    var JavaScriptEtkin = EngineContext.Current.Resolve<AdminAyarları>().RichEditorJavaScriptİzinli;
    var tamEkranEtkin = Convert.ToBoolean(ViewData["RichEditor.EnableFullPage"] ?? false);
}

<script>
    $(document).ready(function() {
        function RoxyFileBrowser@(rastgele)(field_name, url, type, win) {
            var roxyFileman = '@Url.Content("~/Content/Roxy_Fileman/index.html")';
            if (roxyFileman.indexOf("?") < 0) {
                roxyFileman += "?type=" + type;
            } else {
                roxyFileman += "&type=" + type;
            }
            roxyFileman += '&input=' + field_name + '&value=' + document.getElementById(field_name).value;
            tinyMCE.activeEditor.windowManager.open({
                file: roxyFileman,
                title: 'Roxy Fileman',
                width: 850,
                height: 650,
                resizable: "yes",
                plugins: "media",
                inline: "yes",
                close_previous: "no"
            }, { window: win, input: field_name });
            return false;
        }

        var defaultEditorSettings@(rastgele) = {
            selector: "#@ViewData.TemplateInfo.GetFullHtmlFieldId(string.Empty)",
            fontsize_formats: "8pt 9pt 10pt 11pt 12pt 26pt 36pt",
            height: 200,
            width: '100%',
            autoresize_min_height: 200,
            autoresize_max_height: 200,
            plugins: [
                "advlist autolink autoresize directionality lists link image charmap preview anchor",
                "searchreplace visualblocks code fullscreen textcolor",
                "insertdatetime media table contextmenu paste@(JbResimleriEtkin ? " jbimages" : null)@(tamEkranEtkin ? " fullpage" : null)"
            ],
            toolbar: "ltr rtl | insertfile undo redo | styleselect | fontselect | fontsizeselect | bold italic | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image@(JbResimleriEtkin ? " jbimages" : null)",
            relative_urls: false,
            @if (JavaScriptEtkin)
            {
                <text>
            valid_elements: "*[*]",
                </text>
            }
            @if (allowRoxyFileman)
            {
                <text>
            //picture manager
            file_browser_callback: RoxyFileBrowser@(rastgele),
                </text>
            }
            @if (!string.IsNullOrEmpty(language))
            {
                <text>
            //language
            language: "@language",
                </text>
            }
            convert_urls: false,
            entity_encoding: "raw"
        };

        function getAdditionalEditorSettings@(rastgele)(settings) {
            @Html.Raw(ekEditorAyarları)
            return settings;
        }

        tinyMCE.init(getAdditionalEditorSettings@(rastgele)(defaultEditorSettings@(rastgele)));
    });
</script>

@Html.TextArea(string.Empty, /* Name suffix */
    ViewData.TemplateInfo.FormattedModelValue /* Initial value */
)